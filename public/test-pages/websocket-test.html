<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>WebSocket & Slides & Voice Test</title>
    <script src="https://cdn.socket.io/4.6.0/socket.io.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Tajawal', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 20px;
        }
        
        /* Control Panel */
        .control-panel {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            height: fit-content;
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 20px;
            font-size: 24px;
        }
        
        .status {
            padding: 12px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .connected { 
            background: #d4edda; 
            color: #155724;
            border: 2px solid #c3e6cb;
        }
        
        .disconnected { 
            background: #f8d7da; 
            color: #721c24;
            border: 2px solid #f5c6cb;
        }
        
        .button-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        button {
            padding: 10px 20px;
            cursor: pointer;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        button:hover { 
            background: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        button:disabled { 
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .theme-selector {
            margin: 15px 0;
        }
        
        .theme-selector label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        
        .theme-selector select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        /* Voice Controls */
        .voice-controls {
            border-top: 2px solid #eee;
            padding-top: 15px;
            margin-top: 15px;
        }
        
        .voice-controls h3 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .voice-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .audio-player {
            width: 100%;
            margin-top: 10px;
            display: none;
        }
        
        #logs {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            padding: 10px;
            height: 250px;
            overflow-y: auto;
            font-family: 'Consolas', monospace;
            font-size: 12px;
            border-radius: 8px;
            margin-top: 15px;
        }
        
        .log-entry {
            margin-bottom: 3px;
            padding: 3px 5px;
            border-radius: 3px;
        }
        
        .log-success { background: #d4edda; color: #155724; }
        .log-error { background: #f8d7da; color: #721c24; }
        .log-info { background: #e7f3ff; color: #004085; }
        .log-warning { background: #fff3cd; color: #856404; }
        
        /* Slide Viewer */
        .slide-viewer {
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .slide-header {
            background: #333;
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .slide-info {
            font-size: 14px;
        }
        
        .slide-nav {
            display: flex;
            gap: 10px;
        }
        
        .nav-btn {
            padding: 5px 15px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .nav-btn:hover {
            background: #5a67d8;
        }
        
        .nav-btn:disabled {
            background: #666;
            cursor: not-allowed;
        }
        
        #slideContainer {
            height: 600px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            background: #f8f9fa;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- Control Panel -->
        <div class="control-panel">
            <h1>üîå WebSocket + Slides + Voice</h1>
            
            <div id="status" class="status disconnected">ÿ∫Ÿäÿ± ŸÖÿ™ÿµŸÑ</div>
            
            <div class="button-group">
                <button onclick="connect()" id="connectBtn">ÿßÿ™ÿµÿßŸÑ</button>
                <button onclick="disconnect()">ŸÇÿ∑ÿπ ÿßŸÑÿßÿ™ÿµÿßŸÑ</button>
                <button onclick="testPing()" id="pingBtn" disabled>Ping Test</button>
            </div>
            
            <div class="theme-selector">
                <label>Theme:</label>
                <select id="themeSelect">
                    <option value="default">Default</option>
                    <option value="dark">Dark</option>
                    <option value="kids">Kids</option>
                </select>
            </div>
            
            <!-- Voice Controls -->
            <div class="voice-controls">
                <h3>üéôÔ∏è Voice Settings</h3>
                <div class="voice-checkbox">
                    <input type="checkbox" id="generateVoice">
                    <label for="generateVoice">Generate Voice</label>
                </div>
                <button onclick="generateSlideVoice()" disabled id="voiceBtn">
                    Generate Voice for Current Slide
                </button>
                <audio id="audioPlayer" class="audio-player" controls></audio>
            </div>
            
            <div class="button-group">
                <button onclick="requestTitleSlide()" disabled id="titleBtn">Title Slide</button>
                <button onclick="requestContentSlide()" disabled id="contentBtn">Content Slide</button>
                <button onclick="requestBulletSlide()" disabled id="bulletBtn">Bullet Slide</button>
                <button onclick="requestQuizSlide()" disabled id="quizBtn">Quiz Slide</button>
                <button onclick="requestSummarySlide()" disabled id="summaryBtn">Summary Slide</button>
            </div>
            
            <div id="logs"></div>
        </div>
        
        <!-- Slide Viewer -->
        <div class="slide-viewer">
            <div class="slide-header">
                <div class="slide-info">
                    <span>Slide <span id="currentSlide">0</span> / <span id="totalSlides">0</span></span>
                </div>
                <div class="slide-nav">
                    <button class="nav-btn" onclick="navigateSlide('previous')">ÿßŸÑÿ≥ÿßÿ®ŸÇ</button>
                    <button class="nav-btn" onclick="navigateSlide('next')">ÿßŸÑÿ™ÿßŸÑŸä</button>
                </div>
            </div>
            <div id="slideContainer">
                <h2 style="color: #999;">ÿ≥Ÿäÿ∏Ÿáÿ± ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ŸáŸÜÿß ÿ®ÿπÿØ ÿßŸÑÿßÿ™ÿµÿßŸÑ</h2>
            </div>
        </div>
    </div>
    
    <script>
        let socket = null;
        let token = null;
        let slideNumber = 0;
        let slides = [];
        let currentSlideData = null;
        
        function log(msg, type = 'info') {
            const logs = document.getElementById('logs');
            const time = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.className = 'log-entry log-' + type;
            entry.textContent = '[' + time + '] ' + msg;
            logs.appendChild(entry);
            logs.scrollTop = logs.scrollHeight;
        }
        
        async function connect() {
            const btn = document.getElementById('connectBtn');
            btn.disabled = true;
            
            try {
                // Step 1: Login first to get token
                log('üîê ÿ¨ÿßÿ±Ÿä ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ...', 'info');
                
                const loginRes = await fetch('/api/v1/auth/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        email: 'student1@test.com',
                        password: 'Test@1234'
                    })
                });
                
                const loginData = await loginRes.json();
                
                if (!loginData.success) {
                    // Try to register if login failed
                    log('üìù ÿ•ŸÜÿ¥ÿßÿ° ŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ¨ÿØŸäÿØ...', 'info');
                    
                    const registerRes = await fetch('/api/v1/auth/register', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            email: 'student1@test.com',
                            password: 'Test@1234',
                            firstName: 'Test',
                            lastName: 'Student',
                            role: 'STUDENT',
                            grade: 6
                        })
                    });
                    
                    const registerData = await registerRes.json();
                    
                    if (registerData.success) {
                        log('‚úÖ ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ', 'success');
                        
                        // Try login again
                        const retryRes = await fetch('/api/v1/auth/login', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                email: 'student1@test.com',
                                password: 'Test@1234'
                            })
                        });
                        
                        const retryData = await retryRes.json();
                        if (retryData.success) {
                            token = retryData.data.token;
                            log('‚úÖ ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ', 'success');
                        } else {
                            throw new Error('ŸÅÿ¥ŸÑ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ÿ®ÿπÿØ ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ');
                        }
                    } else {
                        throw new Error('ŸÅÿ¥ŸÑ ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ: ' + (registerData.message || 'ÿÆÿ∑ÿ£ ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ'));
                    }
                } else {
                    token = loginData.data.token;
                    log('‚úÖ ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
                }
                
                // Step 2: Connect WebSocket
                log('üîå ÿ¨ÿßÿ±Ÿä ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ŸÄ WebSocket...', 'info');
                
                socket = io('http://localhost:3000', {
                    transports: ['polling', 'websocket']
                });
                
                socket.on('connect', () => {
                    log('‚úÖ ŸÖÿ™ÿµŸÑ! Socket ID: ' + socket.id, 'success');
                    document.getElementById('status').className = 'status connected';
                    document.getElementById('status').textContent = 'ŸÖÿ™ÿµŸÑ - ÿ∫Ÿäÿ± ŸÖÿµÿßÿØŸÇ';
                    
                    // Step 3: Send authentication
                    log('üîë ÿ¨ÿßÿ±Ÿä ÿßŸÑŸÖÿµÿßÿØŸÇÿ©...', 'info');
                    socket.emit('authenticate', { token: token });
                });
                
                // Authentication confirmed
                socket.on('authenticated', (data) => {
                    log('‚úÖ ÿ™ŸÖÿ™ ÿßŸÑŸÖÿµÿßÿØŸÇÿ©: ' + data.userName, 'success');
                    document.getElementById('status').textContent = 'ŸÖÿ™ÿµŸÑ - ' + data.email;
                    
                    // Enable all buttons after successful auth
                    document.getElementById('pingBtn').disabled = false;
                    document.getElementById('titleBtn').disabled = false;
                    document.getElementById('contentBtn').disabled = false;
                    document.getElementById('bulletBtn').disabled = false;
                    document.getElementById('quizBtn').disabled = false;
                    document.getElementById('summaryBtn').disabled = false;
                    document.getElementById('voiceBtn').disabled = false;
                    btn.disabled = false;
                });
                
                // Authentication error
                socket.on('auth_error', (data) => {
                    log('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑŸÖÿµÿßÿØŸÇÿ©: ' + data.message, 'error');
                    document.getElementById('status').textContent = 'ŸÖÿ™ÿµŸÑ - ÿ∫Ÿäÿ± ŸÖÿµÿßÿØŸÇ';
                });
                
                // Welcome message
                socket.on('welcome', (data) => {
                    log('üëã ' + data.message, 'success');
                    if (data.features) {
                        const features = Object.keys(data.features).filter(k => data.features[k]);
                        if (features.length > 0) {
                            log('üìä Features: ' + features.join(', '), 'info');
                        }
                    }
                });
                
                // Slide ready
                socket.on('slide_ready', (data) => {
                    log('üñºÔ∏è ÿ™ŸÖ ÿßÿ≥ÿ™ŸÑÿßŸÖ ÿßŸÑÿ¥ÿ±Ÿäÿ≠ÿ©!', 'success');
                    displaySlide(data.html);
                    slides[data.slideNumber] = data.html;
                    updateSlideInfo(data.slideNumber);
                    
                    // Play audio if available
                    if (data.audioUrl) {
                        const player = document.getElementById('audioPlayer');
                        player.src = data.audioUrl;
                        player.style.display = 'block';
                        player.play().catch(e => {
                            log('‚ö†Ô∏è ÿßÿ∂ÿ∫ÿ∑ ÿπŸÑŸâ ÿßŸÑÿµŸàÿ™ ŸÑŸÑÿ™ÿ¥ÿ∫ŸäŸÑ', 'warning');
                        });
                        log('üéµ ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿµŸàÿ™', 'success');
                    }
                });
                
                // Voice ready
                socket.on('slide_voice_ready', (data) => {
                    log('üéµ ÿ™ŸÖ ÿ™ŸàŸÑŸäÿØ ÿßŸÑÿµŸàÿ™!', 'success');
                    const player = document.getElementById('audioPlayer');
                    player.src = data.audioUrl;
                    player.style.display = 'block';
                    player.play().catch(e => {
                        log('‚ö†Ô∏è ÿßÿ∂ÿ∫ÿ∑ ÿπŸÑŸâ ÿßŸÑÿµŸàÿ™ ŸÑŸÑÿ™ÿ¥ÿ∫ŸäŸÑ', 'warning');
                    });
                });
                
                // Voice error
                socket.on('voice_error', (data) => {
                    log('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿµŸàÿ™: ' + data.message, 'error');
                });
                
                // Slide error
                socket.on('slide_error', (data) => {
                    log('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ¥ÿ±Ÿäÿ≠ÿ©: ' + data.message, 'error');
                });
                
                // General error
                socket.on('error', (data) => {
                    log('‚ùå ÿÆÿ∑ÿ£: ' + (data.message || data), 'error');
                });
                
                // Pong response
                socket.on('pong', (data) => {
                    log('üèì Pong received!', 'success');
                    if (data && data.serverTime) {
                        log('‚è∞ Server time: ' + new Date(data.serverTime).toLocaleTimeString(), 'info');
                    }
                });
                
                // Connection error
                socket.on('connect_error', (error) => {
                    log('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿßÿ™ÿµÿßŸÑ: ' + error.message, 'error');
                    btn.disabled = false;
                });
                
                // Disconnection
                socket.on('disconnect', (reason) => {
                    log('‚ùå ÿßŸÜŸÇÿ∑ÿπ ÿßŸÑÿßÿ™ÿµÿßŸÑ: ' + reason, 'error');
                    document.getElementById('status').className = 'status disconnected';
                    document.getElementById('status').textContent = 'ÿ∫Ÿäÿ± ŸÖÿ™ÿµŸÑ';
                    disableAllButtons();
                    btn.disabled = false;
                });
                
            } catch (error) {
                log('‚ùå ÿÆÿ∑ÿ£: ' + error.message, 'error');
                btn.disabled = false;
            }
        }
        
        function disconnect() {
            if (socket) {
                socket.disconnect();
                socket = null;
                token = null;
                log('üëã ÿ™ŸÖ ŸÇÿ∑ÿπ ÿßŸÑÿßÿ™ÿµÿßŸÑ', 'info');
                document.getElementById('status').className = 'status disconnected';
                document.getElementById('status').textContent = 'ÿ∫Ÿäÿ± ŸÖÿ™ÿµŸÑ';
                disableAllButtons();
                document.getElementById('connectBtn').disabled = false;
            }
        }
        
        function testPing() {
            if (socket && socket.connected) {
                socket.emit('ping');
                log('üèì Sending ping...', 'info');
            } else {
                log('‚ö†Ô∏è ÿ∫Ÿäÿ± ŸÖÿ™ÿµŸÑ', 'warning');
            }
        }
        
        function generateSlideVoice() {
            if (socket && socket.connected && currentSlideData) {
                socket.emit('generate_slide_voice', {
                    slideContent: currentSlideData
                });
                log('üéôÔ∏è ÿ¨ÿßÿ±Ÿä ÿ™ŸàŸÑŸäÿØ ÿßŸÑÿµŸàÿ™...', 'info');
            } else {
                log('‚ö†Ô∏è ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ¥ÿ±Ÿäÿ≠ÿ© ÿ≠ÿßŸÑŸäÿ©', 'warning');
            }
        }
        
        function requestTitleSlide() {
            if (!socket || !socket.connected) {
                log('‚ö†Ô∏è ÿ∫Ÿäÿ± ŸÖÿ™ÿµŸÑ', 'warning');
                return;
            }
            
            const theme = document.getElementById('themeSelect').value;
            const generateVoice = document.getElementById('generateVoice').checked;
            
            currentSlideData = {
                type: 'title',
                title: 'ŸÖÿ±ÿ≠ÿ®ÿßŸã ŸÅŸä ŸÖŸÜÿµÿ© ÿßŸÑÿ™ÿπŸÑŸäŸÖ ÿßŸÑÿ∞ŸÉŸäÿ©',
                subtitle: 'ÿ™ÿπŸÑŸÖ ÿ®ÿ∑ÿ±ŸäŸÇÿ© ÿ™ŸÅÿßÿπŸÑŸäÿ© ŸàŸÖŸÖÿ™ÿπÿ©'
            };
            
            socket.emit('request_slide', {
                slideNumber: ++slideNumber,
                ...currentSlideData,
                theme,
                generateVoice
            });
            
            log('üì§ ÿ∑ŸÑÿ® ÿ¥ÿ±Ÿäÿ≠ÿ© ÿßŸÑÿπŸÜŸàÿßŸÜ' + (generateVoice ? ' ŸÖÿπ ÿßŸÑÿµŸàÿ™' : '') + '...', 'info');
        }
        
        function requestContentSlide() {
            if (!socket || !socket.connected) {
                log('‚ö†Ô∏è ÿ∫Ÿäÿ± ŸÖÿ™ÿµŸÑ', 'warning');
                return;
            }
            
            const theme = document.getElementById('themeSelect').value;
            const generateVoice = document.getElementById('generateVoice').checked;
            
            currentSlideData = {
                type: 'content',
                title: 'ŸÖÿß ŸáŸä ÿßŸÑÿ£ÿπÿØÿßÿØ ÿßŸÑÿ∑ÿ®ŸäÿπŸäÿ©ÿü',
                content: 'ÿßŸÑÿ£ÿπÿØÿßÿØ ÿßŸÑÿ∑ÿ®ŸäÿπŸäÿ© ŸáŸä ÿßŸÑÿ£ÿπÿØÿßÿØ ÿßŸÑÿ™Ÿä ŸÜÿ≥ÿ™ÿÆÿØŸÖŸáÿß ŸÑŸÑÿπÿØÿå Ÿàÿ™ÿ®ÿØÿ£ ŸÖŸÜ ÿßŸÑÿ±ŸÇŸÖ 1 Ÿàÿ™ÿ≥ÿ™ŸÖÿ± ÿ•ŸÑŸâ ŸÖÿß ŸÑÿß ŸÜŸáÿßŸäÿ©. ŸÖÿ´ŸÑ: 1ÿå 2ÿå 3ÿå 4ÿå 5 ŸàŸáŸÉÿ∞ÿß.'
            };
            
            socket.emit('request_slide', {
                slideNumber: ++slideNumber,
                ...currentSlideData,
                theme,
                generateVoice
            });
            
            log('üì§ ÿ∑ŸÑÿ® ÿ¥ÿ±Ÿäÿ≠ÿ© ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ' + (generateVoice ? ' ŸÖÿπ ÿßŸÑÿµŸàÿ™' : '') + '...', 'info');
        }
        
        function requestBulletSlide() {
            if (!socket || !socket.connected) {
                log('‚ö†Ô∏è ÿ∫Ÿäÿ± ŸÖÿ™ÿµŸÑ', 'warning');
                return;
            }
            
            const theme = document.getElementById('themeSelect').value;
            const generateVoice = document.getElementById('generateVoice').checked;
            
            currentSlideData = {
                type: 'bullet',
                title: 'ÿÆÿµÿßÿ¶ÿµ ÿßŸÑÿ£ÿπÿØÿßÿØ ÿßŸÑÿ∑ÿ®ŸäÿπŸäÿ©',
                bullets: [
                    'ÿ™ÿ®ÿØÿ£ ŸÖŸÜ ÿßŸÑÿπÿØÿØ 1',
                    'ŸÑÿß ÿ™ÿ≠ÿ™ŸàŸä ÿπŸÑŸâ ŸÉÿ≥Ÿàÿ± ÿ£Ÿà ÿ£ÿπÿØÿßÿØ ÿπÿ¥ÿ±Ÿäÿ©',
                    'ÿ™ÿ≥ÿ™ŸÖÿ± ÿ•ŸÑŸâ ŸÖÿß ŸÑÿß ŸÜŸáÿßŸäÿ©',
                    'ÿ™Ÿèÿ≥ÿ™ÿÆÿØŸÖ ŸÅŸä ÿßŸÑÿπÿØ ŸàÿßŸÑÿ™ÿ±ÿ™Ÿäÿ®'
                ]
            };
            
            socket.emit('request_slide', {
                slideNumber: ++slideNumber,
                ...currentSlideData,
                theme,
                generateVoice
            });
            
            log('üì§ ÿ∑ŸÑÿ® ÿ¥ÿ±Ÿäÿ≠ÿ© ÿßŸÑŸÜŸÇÿßÿ∑' + (generateVoice ? ' ŸÖÿπ ÿßŸÑÿµŸàÿ™' : '') + '...', 'info');
        }
        
        function requestQuizSlide() {
            if (!socket || !socket.connected) {
                log('‚ö†Ô∏è ÿ∫Ÿäÿ± ŸÖÿ™ÿµŸÑ', 'warning');
                return;
            }
            
            const theme = document.getElementById('themeSelect').value;
            
            currentSlideData = {
                type: 'quiz',
                quiz: {
                    question: 'ÿ£Ÿä ŸÖŸÜ ÿßŸÑÿ™ÿßŸÑŸä ŸäŸèÿπÿ™ÿ®ÿ± ÿπÿØÿØ ÿ∑ÿ®ŸäÿπŸäÿü',
                    options: ['0.5', '-3', '7', '2.5'],
                    correctIndex: 2
                }
            };
            
            socket.emit('request_slide', {
                slideNumber: ++slideNumber,
                ...currentSlideData,
                theme,
                generateVoice: false // No voice for quiz
            });
            
            log('üì§ ÿ∑ŸÑÿ® ÿ¥ÿ±Ÿäÿ≠ÿ© ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±...', 'info');
        }
        
        function requestSummarySlide() {
            if (!socket || !socket.connected) {
                log('‚ö†Ô∏è ÿ∫Ÿäÿ± ŸÖÿ™ÿµŸÑ', 'warning');
                return;
            }
            
            const theme = document.getElementById('themeSelect').value;
            const generateVoice = document.getElementById('generateVoice').checked;
            
            currentSlideData = {
                type: 'summary',
                title: 'ÿßŸÑÿÆŸÑÿßÿµÿ©',
                bullets: [
                    'ÿ™ÿπŸÑŸÖŸÜÿß ÿ™ÿπÿ±ŸäŸÅ ÿßŸÑÿ£ÿπÿØÿßÿØ ÿßŸÑÿ∑ÿ®ŸäÿπŸäÿ©',
                    'ÿπÿ±ŸÅŸÜÿß ÿÆÿµÿßÿ¶ÿµŸáÿß ÿßŸÑŸÖŸÖŸäÿ≤ÿ©',
                    'ÿ™ÿØÿ±ÿ®ŸÜÿß ÿπŸÑŸâ ÿßŸÑÿ™ŸÖŸäŸäÿ≤ ÿ®ŸäŸÜŸáÿß Ÿàÿ®ŸäŸÜ ÿßŸÑÿ£ÿπÿØÿßÿØ ÿßŸÑÿ£ÿÆÿ±Ÿâ'
                ]
            };
            
            socket.emit('request_slide', {
                slideNumber: ++slideNumber,
                ...currentSlideData,
                theme,
                generateVoice
            });
            
            log('üì§ ÿ∑ŸÑÿ® ÿ¥ÿ±Ÿäÿ≠ÿ© ÿßŸÑŸÖŸÑÿÆÿµ' + (generateVoice ? ' ŸÖÿπ ÿßŸÑÿµŸàÿ™' : '') + '...', 'info');
        }
        
        function displaySlide(html) {
            document.getElementById('slideContainer').innerHTML = html;
        }
        
        function updateSlideInfo(num) {
            document.getElementById('currentSlide').textContent = num || slideNumber;
            document.getElementById('totalSlides').textContent = slides.filter(s => s).length;
        }
        
        function navigateSlide(direction) {
            if (direction === 'next' && slideNumber < slides.length - 1) {
                slideNumber++;
            } else if (direction === 'previous' && slideNumber > 1) {
                slideNumber--;
            }
            
            if (slides[slideNumber]) {
                displaySlide(slides[slideNumber]);
                updateSlideInfo(slideNumber);
                log(`üìç ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ŸÑŸÑÿ¥ÿ±Ÿäÿ≠ÿ© ${slideNumber}`, 'info');
            }
        }
        
        function disableAllButtons() {
            document.getElementById('pingBtn').disabled = true;
            document.getElementById('titleBtn').disabled = true;
            document.getElementById('contentBtn').disabled = true;
            document.getElementById('bulletBtn').disabled = true;
            document.getElementById('quizBtn').disabled = true;
            document.getElementById('summaryBtn').disabled = true;
            document.getElementById('voiceBtn').disabled = true;
        }
        
        // Initialize on page load
        window.onload = () => {
            log('üöÄ ÿ¨ÿßŸáÿ≤ ŸÑŸÑÿßÿÆÿ™ÿ®ÿßÿ±', 'info');
            log('üí° ÿßÿ∂ÿ∫ÿ∑ "ÿßÿ™ÿµÿßŸÑ" ŸÑŸÑÿ®ÿØÿ°', 'info');
            log('üìå ÿßŸÑÿ≥Ÿäÿ±ŸÅÿ± ÿπŸÑŸâ port 3000', 'info');
        };
    </script>
</body>
</html>